pkgname=${APPLICATION_NAME}
pkgver=${APPLICATION_VERSION}
pkgrel=${PACKAGE_VERSION}
arch=(${APPLICATION_ARCH})
pkgdesc="A generical independent tool to configure the hyprland environment by a GTK GUI."
url="https://github.com/Jinoyoko-Fusunshi/HyprSettings"
depends=("gtk4")
makedepends=('rust' 'cargo')
options=('!debug')
source=()
sha256sums=()

prepare() {
    # recreate out output directory
    if [ -f "out" ]; then
      rm -r "out"
    fi
}

build() {
    cd "$srcdir"

    # build binary
    cargo build --release
}

package() {
    shared_directory="/usr/share/$pkgname"
    dark_style="dark-style.css"
    light_style="light-style.css"
    cd ../../../

    # setup package directory structure
    install -d "$pkgdir/usr/share/$pkgname"
    install -d "$pkgdir/usr/share/applications"

    # copy binary with resources into the package
    install -Dm755 "target/release/$pkgname" "$pkgdir/usr/bin/$pkgname"

    install -Dm755 "res/$dark_style" "$pkgdir$shared_directory/$dark_style"
    install -Dm755 "res/$light_style" "$pkgdir$shared_directory/$light_style"
    install -Dm755 "res/$pkgname.desktop" "$pkgdir/usr/share/applications/$pkgname.desktop"
}